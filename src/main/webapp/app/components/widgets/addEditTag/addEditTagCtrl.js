module.exports = function ($scope, $uibModalInstance, $resource, NgTableParams, method, currentTag) {
    
    var tagObj = currentTag;
    $scope.method = method;

    if ('重命名' === method) {
        var url = '/tag/sys/updateTag';
        $scope.tagName = tagObj.tagname;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
    }  else {
        var url = '/tag/sys/addTag';
        tagObj = {tagid: '', tagname: ''};
        
    }

    url = url + '?accessId=1';

    $scope.submit = function () {  

        if (!$scope.tagName || ($scope.tagName.length > 32)) {
            $scope.errorMsg = '参数非法!';
            return; 
        } 

        tagObj.tagname = $scope.tagName; 

        $resource(url).save(tagObj).$promise.then(
            function (ack) {

            if (ack.respCode != '1000') {
                $scope.errorMsg = ack.content;
                return;
            }
            
            $scope.queryTag();
            $uibModalInstance.close();

        });

    };

    $scope.userInputClick = function () {
        $scope.errorMsg = '';
    };

    $scope.cancle = function () {
        $uibModalInstance.close();
        $scope.queryTag();
    };

}
